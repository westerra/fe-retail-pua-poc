<form *ngIf="formGroup" [formGroup]="formGroup">
  <bb-collapsible-ui class="card" [isOpen]="isCardExpanded">
    <ng-template bbCollapsibleHeader>
      <div [ngClass]="isCardExpanded ? 'card-header' : 'card-body'" id="account-notifications-detail-balance-section">
        <div class="bb-stack">
          <bb-header-ui
            class="bb-stack__item"
            headingType="h5"
            heading="Balance"
            i18n-heading="Account balance recipe heading@@actions-common.account-balance-recipe.heading"
            data-role="balance-header"
          ></bb-header-ui>
          <bb-switch-with-loading
            [isLoading]="isLoading"
            (change)="onActiveLoadingChange()"
            formControlName="active"
            class="bb-stack__item bb-stack__item--push-right"
            aria-label="Enable and expand account balance notifications"
            i18n-aria-label="
              Account balance switcher aria label@@actions-common.account-balance-recipe.switcher.aria-label"
            data-role="balance-switcher"
          ></bb-switch-with-loading>
        </div>
        <div
          class="bb-text-support"
          i18n="Account balance subheading@@actions-common.account-balance-recipe-form.subheading"
          data-role="balance-sub-header"
        >
          Receive notifications when your current balance is lower than a set amount
        </div>
      </div>
    </ng-template>
    <ng-template bbCollapsibleBody>
      <div class="card-body">
        <label
          id="currency-input-label"
          class="bb-label"
          i18n="Lower than input label@@actions-common.account-balance-recipe.lower-than-input"
          >Lower than
        </label>
        <div class="row">
          <div class="col-sm-6 col-12 bb-block bb-block--md">
            <ng-template #amountTemplate>
              <bb-amount-ui
                class="bb-highlight"
                [amount]="updatedAmount(formGroup.get('amount')?.value.amount)"
                [currency]="account?.currency"
                [trailingZeroes]="true"
              ></bb-amount-ui>
            </ng-template>
            <bb-input-inline-edit-ui
              [pattern]="balanceAmountPattern"
              (accept)="onInlineEditAccept($event)"
              [inputText]="updatedAmount(formGroup.get('amount')?.value?.amount)"
              [inputInlineTemplate]="amountTemplate"
              data-role="balance-input"
              i18n-ariaLabelEdit="
                Edit amount without
                fractions@@actions-common.account-balance-recipe.edit-amount-without-fractions-button"
              ariaLabelEdit="Edit amount without fractions"
            ></bb-input-inline-edit-ui>
          </div>
        </div>
        <bb-actions-notification-channels-custom
          formGroupName="actions"
          [actions]="specificationActions"
        ></bb-actions-notification-channels-custom>
      </div>
    </ng-template>
  </bb-collapsible-ui>
</form>
