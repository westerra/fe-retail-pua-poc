<bb-accounts-list-header
  (editAccountsAction)="navigateToAccountManagement()"
  (connectExternalAccountAction)="openFastLink()"
  [isManageAccountsLoading]="(externalAccountAggregationService.isLoading$ | async) ?? false"
  [isManageAccountsEnabled]="config.enableManageAccounts"
  [isAccountLinkingEnabled]="config.enableAccountLinking"
></bb-accounts-list-header>

<ng-container *ngIf="(isLoading$ | async) === false && (productKinds$ | async) as items; else accountsNotReadyTemplate">
  <bb-accounts-total-balance
    *ngIf="items.total"
    [balance]="items.total.aggregatedBalance"
    [currency]="items.total.currency"
  ></bb-accounts-total-balance>

  <bb-ongoing-aggregation-alert [ongoingAggregation$]="ongoingAggregation$"></bb-ongoing-aggregation-alert>

  <bb-product-kinds-list-extended
    [showIcons]="config.showAccountIcons"
    [productKinds]="items.productKinds"
    (selectAccount)="onProductSelect($event)"
  ></bb-product-kinds-list-extended>
</ng-container>

<ng-container *ngIf="(isLoading$ | async) === true">
  <bb-loading-indicator-ui loaderSize="lg" [showDelay]="750" [text]="'Loading....'"></bb-loading-indicator-ui>
</ng-container>

<ng-template #accountsNotReadyTemplate>
  <bb-accounts-not-ready-state [errorMessage]="(loadingError$ | async) ?? undefined"></bb-accounts-not-ready-state>
</ng-template>
