<ng-container *ngIf="(hostRef.paginationType | async)! === PaginationType.INFINITE_SCROLL && (selectedAccount | async)! as selectedAccount">
  <ng-container
    [ngTemplateOutlet]="bbPaginatedTransactionsContainer"
    [ngTemplateOutletContext]="{ $implicit: hostRef }"
  ></ng-container>
  <ng-container *ngIf="hostRef.errors">
    <div class="mb-4">
      <bb-alert-ui
        *ngFor="let error of hostRef.errors"
        title="Couldn't load more transactions"
        modifier="error"
        attr.data-role="alert-error"
      >
        <p>{{ error?.message }}</p>
        <a [routerLink]="[]" class="alert-link" (click)="hostRef.retry()">click here</a>
      </bb-alert-ui>
    </div>
  </ng-container>
</ng-container>

<ng-container *ngIf="(hostRef.paginationType | async) !== PaginationType.INFINITE_SCROLL && (selectedAccount | async) as selectedAccount">
  <ng-container *ngIf="!errors; else errorState">
    <ng-container
      [ngTemplateOutlet]="bbPaginatedTransactionsContainer"
      [ngTemplateOutletContext]="{ $implicit: hostRef }"
    ></ng-container>
  </ng-container>

  <ng-template #notificationErrorUpdateHeader>
    <ng-container [ngSwitch]="hostRef.storedExportType?.reason">
      <ng-container *ngSwitchCase="'MIXED_PRODUCT_KINDS'">
        {{ hostRef.storedExportType?.name }}
        <ng-container
          i18n="Invalid export type header for mixed products kinds|Notification header due to mixed product kinds@@transaction.list.toolTip.error.header.MixedProductKinds"        >
          export not supported
        </ng-container>
      </ng-container>
      <ng-container *ngSwitchCase="'UNSUPPORTED_PRODUCT_KIND'">
        {{ hostRef.storedExportType?.name }}
        <ng-container
          i18n="
            Invalid export type header for unsupported product kind|Notification header due to unsupported product
            kind@@transaction.list.toolTip.error.header.UnsupportedProductKind"
        >
          export not supported
        </ng-container>
      </ng-container>
      <ng-container
        *ngSwitchCase="'TOO_MANY_ITEMS'"
        i18n="
          Invalid export type header for too many items|Notification header due to too many
          transactions@@transaction.list.toolTip.error.header.TooManyItems"
      >
        Maximum export threshold exceeded
      </ng-container>
      <ng-container
        *ngSwitchCase="'MULTIPLE_PRODUCTS'"
        i18n="
          Invalid export type header for Multiple Products |Notification header due to Multiple
          Products@@transaction.list.toolTip.error.header.MultipleProducts"
      >
        Multiple products are selected
      </ng-container>
      <ng-container
        *ngSwitchCase="'EXTERNAL_ACCOUNT_NOT_SUPPORTED'"
        i18n="
          Invalid export type header for External Accounts |Notification header due to External Account not supported
          @@transaction.list.toolTip.error.header.ExternalAccount"
      >
        Export Failed
      </ng-container>
      <ng-container
        *ngSwitchDefault
        i18n="
          Default failed export header |Default failed export notification header
          @@transaction.list.toolTip.error.header.DefaultFailedExport"
      >
        Export Failed
      </ng-container>
    </ng-container>
  </ng-template>

  <ng-template #notificationErrorUpdateMessage>
    <ng-container [ngSwitch]="hostRef.storedExportType?.reason">
      <ng-container
        *ngSwitchCase="'MIXED_PRODUCT_KINDS'"
        i18n="
          Invalid export type mixed products kinds|Notification message due to mixed product
          kinds@@transaction.list.toolTip.error.message.MixedProductKinds"
      >
        This export is not supported for your selection
      </ng-container>
      <ng-container
        *ngSwitchCase="'UNSUPPORTED_PRODUCT_KIND'"
        i18n="
          Invalid export type unsupported product kind|Notification message due to unsupported product
          kind@@transaction.list.toolTip.error.message.UnsupportedProductKind"
      >
        This export is not supported for your selection
      </ng-container>
      <ng-container
        *ngSwitchCase="'TOO_MANY_ITEMS'"
        i18n="
          Invalid export type too many items|Notification message due to too many
          transactions@@transaction.list.toolTip.error.message.TooManyItems"
      >
        Please provide different filter\\search criteria
      </ng-container>
      <ng-container
        *ngSwitchCase="'MULTIPLE_PRODUCTS'"
        i18n="
          Invalid export type Multiple Products|Notification message due to Multiple
          Products@@transaction.list.toolTip.error.message.MultipleProducts"
      >
        Please select only one product. For example, only one current account
      </ng-container>
      <ng-container
        *ngSwitchCase="'EXTERNAL_ACCOUNT_NOT_SUPPORTED'"
        i18n="
          Invalid export type External Accounts|Notification message due to External Account not supported
          @@transaction.list.toolTip.error.message.ExternalAccount"
      >
        This file type is not supported by this account.
      </ng-container>
      <ng-container
        *ngSwitchDefault
        i18n="
          Default failed export message|Default failed export notification message
          @@transaction.list.toolTip.error.message.DefaultFailedExport"
      >
        Please try again later.
      </ng-container>
    </ng-container>
  </ng-template>
</ng-container>

<ng-container
  *ngIf="!(selectedAccount | async) as selectedAccount"
  bbTransactionsNoAccountSelectedStateCustomizable
  [bbHostRef]="hostRef"
></ng-container>

<ng-template #errorState>
  <ng-container bbTransactionsErrorStateCustomizable [bbHostRef]="hostRef"></ng-container>
</ng-template>

<ng-template bbTransactionsNoAccountSelectedStateCustomizable let-hostRef>
  <div class="card">
    <div class="card-body bb-state-container">
      <bb-empty-state-ui
        i18n-title="No Product selected|Empty Product selector@@transactions.state.noProductSelected.title"
        title="No Product Selected"
        i18n-subtitle="Product selector@@transactions.state.noProductSelected.subtitle"
        subtitle="Please select a product first."
        iconSize="xl"
        iconModifier="list"
      ></bb-empty-state-ui>
    </div>
  </div>
</ng-template>

<ng-template bbTransactionsErrorStateCustomizable let-hostRef>
  <div class="card">
    <div class="card-body col-md-4 offset-md-4 bb-text-align-center">
      <div class="bb-block bb-block--md">
        <bb-empty-state-ui title=""></bb-empty-state-ui>
        <p
          *ngFor="let error of hostRef.errors"
          data-role="custom-error-state-message"
          class="bb-empty-state__message bb-empty-state"
        >
          {{ error?.message }}
        </p>
      </div>
      <div>
        <button i18n="Retry button@transactions.state.error.retry-button" bbButton (click)="hostRef.retry()">
          Retry
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #notificationServerErrorHeader i18n="Internal error header|Internal error header@@transaction.list.error.header.internal">
  Transactions export is currently not available
</ng-template>
  
<ng-template #notificationServerErrorMessage i18n="Internal error message|Internal error message@@transaction.list.error.message.internal">
  Please try again later
</ng-template>

<ng-template #bbPaginatedTransactionsContainer let-hostRef>
  <div class="card card-lg bb-transactions-list-container">
    <div class="no-print">
      <bb-transactions-controls
        *ngIf="(hostRef.showControls | async)!"
        [isFilterApplied]="(hostRef.isFilterApplied | async)!"
        [hideBillingStatus]="(hostRef.showPendingTransactionsOnTop | async)!"
        [exportConfig]="(hostRef.exportConfig | async)!"
        [availableFilters]="(hostRef.availableFilters | async) || []"
        (search)="hostRef.onSearch($event)"
        (filter)="hostRef.onFilter($event)"
        (print)="hostRef.onPrint()"
        (export)="hostRef.onExport($event)"
      ></bb-transactions-controls>
      <bb-transactions-number-of-results-found
        [numberOfResultsFound]="(hostRef.numberOfResultsFound | async)!"
        [loadingState]="(hostRef.loadingState | async)!"
        [isFilterApplied]="(hostRef.isFilterApplied | async)!"
        [isSearchApplied]="(hostRef.isSearchApplied | async)!"
      ></bb-transactions-number-of-results-found>
    </div>

    <div class="card-body transaction_container_print">
      <bb-pending-transactions-list
        *ngIf="(hostRef.showPendingTransactionsOnTop | async)!"
        [transactionsList]="(hostRef.pendingTransactionsList | async)!"
        [currentPage]="(hostRef.currentPage | async)!"
        [pageSize]="(hostRef.pageSize | async)!"
        [paginationType]="(hostRef.paginationType | async)!"
        [maxNavPages]="(hostRef.maxNavPages | async)!"
        [loadingState]="(hostRef.loadingPendingState | async)!"
        [showChangeCategory]="(hostRef.showChangeCategory | async)!"
        [inquireAndDisputeTopics]="(hostRef.inquireAndDisputeTopics | async)!"
        (detailsOpen)="hostRef.onDetailOpen($event)"
      ></bb-pending-transactions-list>
      <bb-transactions-list-extended
        [transactionsList]="(hostRef.transactionsList | async)!"
        [checkImagesList]="(hostRef.checkImagesList | async)!"
        [currentPage]="(hostRef.currentPage | async)!"
        [pageSize]="(hostRef.pageSize | async)!"
        [maxNavPages]="(hostRef.maxNavPages | async)!"
        [loadingState]="(hostRef.loadingState | async)!"
        [paginationType]="(hostRef.paginationType | async)!"
        [numberOfResultsFound]="(hostRef.numberOfResultsDisplayed | async)!"
        [showChangeCategory]="(hostRef.showChangeCategory | async)!"
        [transactionDetailsLoadingStatus]="(hostRef.transactionDetailsLoadingStatus | async)!"
        [inquireAndDisputeTopics]="(hostRef.inquireAndDisputeTopics | async)!"
        [account]="account"
        (loadMore)="hostRef.onLoadMore()"
        (pageChange)="hostRef.onPageChange($event)"
        (detailsOpen)="hostRef.onDetailOpen($event)"
      ></bb-transactions-list-extended>
    </div>
  </div>
</ng-template>
