<bb-modal-ui [isOpen]="isDetailsOpen" [modalOptions]="{ centered: true }" (cancel)="closeDetails()">
  <div role="dialog">
    <bb-modal-header-ui>
      <ng-template bbCustomModalHeader>
        <button bbButton class="close bb-transaction-list-item-detail-header__close-button" [circle]="true"
          buttonSize="sm" color="unstyled" (click)="closeDetails()" aria-label="Close modal dialog"
          i18n-aria-label="Close template detail dialog@@modal-container.close-btn">
          <bb-icon-ui color="muted" name="clear"></bb-icon-ui>
        </button>
      </ng-template>
    </bb-modal-header-ui>
    <!-- Details -->
    <bb-modal-body-ui>
      <ng-template bbCustomModalBody>
        <div class="bb-text-align-center">
          <!-- Category icon-->
          <div class="bb-block bb-block--md">
            <div class="bb-stack bb-stack--center">
              <bb-transaction-category-icon
                [transaction]="transaction"
                backgroundType="circle"
                size="large"
              ></bb-transaction-category-icon>
            </div>
          </div>
          <!-- Merchant name, Counter party, description -->
          <div class="bb-block bb-block--md" *ngIf="transaction?.merchant">
            <strong>
              <!-- {{ transaction?.merchant?.name || transaction?.counterPartyName || transaction?.description || '' }} -->
              {{ transaction?.merchant?.name || '' }}
            </strong>
          </div>
          <!-- Amount -->
          <div class="bb-heading-2 bb-block bb-block--md">
            <bb-amount-ui
              data-role="list-details-amount"
              [showPlusSign]="true"
              [currency]="transaction?.transactionAmountCurrency?.currencyCode || ''"
              [amount]="transaction?.transactionAmountCurrency?.amount || 0"
            ></bb-amount-ui>
            <ng-container *ngIf="transaction?.currencyExchangeAvailability">
              <bb-icon-ui
                class="bb-transaction-list-item-detail-header__exchange-icon"
                role="tooltip"
                name="exchange"
                size="md"
                [bbTooltip]="tipContent"
                triggers="hover click"
                placement="right"
                bbAccessibilityKeyboard
              ></bb-icon-ui>
              <span
                class="sr-only"
                i18n="An exchange rate has been applied to the current transaction@@transactions.details.exchangeRate"
                >An exchange rate has been applied</span
              >
            </ng-container>
          </div>
          <!-- Date -->
          <div class="bb-block bb-block--md" *ngIf="transaction?.bookingDate">
            <div class="break-word text-small" data-role="list-details-booking-date">
              {{ transaction?.bookingDate | date: 'longDate' }}
            </div>
          </div>
          <!-- Category name -->
          <div class="bb-block bb-block--lg">
            <bb-transaction-detail-category
              (categoryChange)="closeTransactionsCategory($event)"
              [displayChangeCategory]="showChangeCategory"
              [transaction]="transaction"
            >
            </bb-transaction-detail-category>
          </div>
          <!-- Billing status -->
          <div
            class="bb-block bb-block--md"
            *ngIf="
              !showBillingStatus &&
              (transaction?.billingStatus === 'UNBILLED' || transaction?.billingStatus === 'PENDING')
            "
          >
            <bb-badge-ui
              text="{{ transaction?.billingStatus }}"
              color="warning"
              [abbr]="false"
              [circle]="false"
            ></bb-badge-ui>
          </div>
          <div class="bb-block bb-block--md bb-text-align-left">
            <ng-container *ngIf="alertOptions.displayAlert" [ngSwitch]="alertOptions.displayStatus">
              <bb-alert-ui
                *ngSwitchCase="'error'"
                title="Transaction category was not changed"
                i18n-title="
                  Update failed notification|Message for a notification displayed when transaction category update
                  request has failed@@transaction.notification.error.update"
                [dismissible]="true"
                (close)="onAlertDismiss()"
              ></bb-alert-ui>
              <bb-alert-ui
                *ngSwitchCase="'success'"
                modifier="success"
                title="Transaction category changed successfully"
                i18n-title="
                  Update notification|Message for a notification displayed when transaction category update request has
                  been processed@@transaction.notification.success.update"
                [dismissible]="true"
                (close)="onAlertDismiss()"
              ></bb-alert-ui>
            </ng-container>
          </div>
        </div>
        <bb-transactions-detail-extended
          *ngIf="isDetailsOpen"
          [transaction]="transaction"
          [(isEditingNotes)]="isEditingNotes"
          [(showInquiryAndDispute)]="showInquiryAndDispute"
          [checkImagesList]="checkImagesList"
          [transactionDetailsLoadingStatus]="transactionDetailsLoadingStatus"
          [inquireAndDisputeTopics]="inquireAndDisputeTopics"
          [isPending]="isPending"
          [account]="account"
        ></bb-transactions-detail-extended>
      </ng-template>
    </bb-modal-body-ui></div></bb-modal-ui
><ng-template #tipContent>
  <div class="bb-text-align-left">
    <span
      i18n="
        Description inside a tooltip describing an exchange rate has ocurred@@transactions.details.exchangeRate.tooltip"
    >
      An exchange rate has been applied
    </span>
  </div></ng-template
>
