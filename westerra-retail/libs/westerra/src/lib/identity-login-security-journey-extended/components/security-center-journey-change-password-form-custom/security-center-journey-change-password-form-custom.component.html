<div *ngIf="form">
  <div class="bb-block bb-block--lg">
    <bb-header-ui
      headingType="h3"
      heading="Change Password"
      i18n-heading="Header for changing a users password@@bb-user-identity-security-center-journey-form.bb-header-ui"
    >
    </bb-header-ui>
  </div>
  <div
    class="bb-block bb-block--lg"
    i18n="Label for current password description@@bb-user-identity-security-center-journey.current-password-description"
  >
    To change your password, we must verify your current one first.
  </div>
  <form [formGroup]="form" (submit)="onSubmit()">
    <div data-role="identity-security-center-change-password-form">
      <div class="bb-block bb-block--xl">
        <bb-input-password-ui
          class="bb-form-field bb-form-field--md"
          label="Current password"
          i18n-label="
            Current password input label|Label text for current password
            input@@bb-user-identity-security-center-journey.current-password-input-label"
          formControlName="currentPassword"
          [autofocus]="true"
          [maxLength]="255"
          [showVisibilityControl]="true"
          data-role="identity-security-center-current-password-input"
        >
        </bb-input-password-ui>
        <bb-input-validation-message-ui [showErrors]="showErrors(form.controls.currentPassword)">
          <span
            *ngIf="form.controls.currentPassword.errors?.required"
            data-role="identity-security-center-current-password-error"
            i18n="
              Error message for blank current password field|Error message requiring password for current password
              field@@bb-user-identity-security-center-journey.current-password-blank-error-message"
          >
            You must enter your current password
          </span>
        </bb-input-validation-message-ui>
      </div>

      <!-- <div class="bb-block bb-block--lg">
        <div
          class="bb-block bb-block--lg"
          i18n="Text for password form description@@bb-user-identity-security-center-journey.password-form-text"
        >
          Your new password must contain:
        </div>

        <ul>
          <li
            i18n="
              Text for minimum length password policy bullet
              point@bb-user-identity-security-center-journey.password-form-policy-length
            "
          >
            A minimum of 6 characters
          </li>
          <li
            i18n="
              Text for uppercase password policy bullet
              point@bb-user-identity-security-center-journey.password-form-policy-uppercase
            "
          >
            At least one UPPERCASE letter
          </li>
          <li
            i18n="
              Text for lowercase password policy bullet
              point@bb-user-identity-security-center-journey.password-form-policy-lowecase
            "
          >
            At least one lowercase letter
          </li>
        </ul>
      </div> -->

      <div class="bb-block bb-blockâ€”md bb-stack bb-stack--wrap align-items-stretch">
        <div class="bb-stack__item bb-stack__item--fill">
          <div class="bb-block bb-block--sm bb-stack bb-stack--density-sm">
            <span
              class="bb-stack__item bb-text-bold"
              i18n="Text for password form description@@bb-user-identity-security-center-widget.password-form-text"
              >Your new password must contain:</span
            >
          </div>
          <div>
            <ul>
              <li
                i18n="
                  Text for minimum length password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-length
                "
              >
                A minimum of 9 characters
              </li>
              <li
                i18n="
                  Text for uppercase password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-uppercase
                "
              >
                At least one UPPERCASE letter
              </li>
              <li
                i18n="
                  Text for lowercase password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-lowercase
                "
              >
                At least one lowercase letter
              </li>
              <li
                i18n="
                  Text for number password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-number
                "
              >
                At least one number
              </li>
              <li
                i18n="
                  Text for lowercase password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-special-character
                "
              >
                At least one special character
              </li>
            </ul>
          </div>
        </div>

        <div class="bb-stack__break bb-stack__break--sm-down bb-stack__break--spacing-md"></div>

        <div class="bb-stack__item bb-stack__item--fill">
          <div class="bb-block bb-block--sm bb-stack bb-stack--density-sm">
            <span
              class="bb-stack__item bb-text-bold"
              i18n="Text for password form description@@bb-user-identity-security-center-widget.password-form-text"
              >Your new password <u>CANNOT</u> be:</span
            >
          </div>
          <div>
            <ul>
              <li
                i18n="
                  Text for number password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-username
                "
              >
                Your username
              </li>
              <li
                i18n="
                  Text for number password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-email-address
                "
              >
                Your email address
              </li>
              <li
                i18n="
                  Text for number password policy bullet
                  point@bb-user-identity-security-center-widget.password-form-policy-previous-passwords
                "
              >
                Any of the last 5 previous passwords
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="form-group">
        <bb-input-password-ui
          class="bb-form-field bb-form-field--md"
          label="New password"
          formControlName="inputNewPassword"
          [maxLength]="255"
          [showVisibilityControl]="true"
          data-role="identity-security-center-new-password-input"
          i18n-label="
            New password input label|Label text for new password
            input@@bb-user-identity-security-center-journey.new-password-input-label"
        >
        </bb-input-password-ui>
        <bb-input-validation-message-ui [showErrors]="showErrors(form.controls.inputNewPassword)">
          <span
            *ngIf="form.controls.inputNewPassword.errors?.required"
            data-role="identity-security-center-new-password-error"
            i18n="
              Error message for blank new password field|Error message requiring password for new password
              field@@bb-user-identity-security-center-journey.new-password-blank-error-message"
          >
            You must enter a new password
          </span>
          <span
            *ngIf="form.controls.inputNewPassword.errors?.usedPassword"
            data-role="identity-security-center-old-password-error"
            i18n="
              Error message for current password matching new password field|Error message requiring unique password for
              new password field@@bb-user-identity-security-center-journey.new-password-unique-error-message"
          >
            New password must be different to current password
          </span>
        </bb-input-validation-message-ui>
      </div>

      <div class="bb-block bb-block--lg">
        <bb-input-password-ui
          class="bb-form-field bb-form-field--md"
          label="Confirm new password"
          formControlName="confirmNewPassword"
          [maxLength]="255"
          [showVisibilityControl]="true"
          data-role="identity-security-center-confirm-password-input"
          i18n-label="
            Confirm password input label|Label text for confirm password
            input@@bb-user-identity-security-center-journey.confirm-password-input-label"
        >
        </bb-input-password-ui>
        <bb-input-validation-message-ui [showErrors]="showErrors(form.controls.confirmNewPassword)">
          <span
            *ngIf="form.controls.confirmNewPassword.errors?.mismatched"
            data-role="identity-security-center-confirm-password-mismatch-error"
            i18n="
              Error message for mismatch passwords|Error message for mismatch passwords for confirm new password
              field@@bb-user-identity-security-center-journey.confirm-password-mismatch-error-message"
          >
            Passwords don't match
          </span>
          <span
            *ngIf="form.controls.confirmNewPassword.errors?.required"
            data-role="identity-security-center-confirm-password-blank-error"
            i18n="
              Error message for blank password|Error message for blank password for confirm new password
              field@@bb-user-identity-security-center-journey.confirm-password-blank-error-message"
          >
            You must re-type your new password
          </span>
        </bb-input-validation-message-ui>
      </div>
    </div>
    <div class="bb-button-bar--reverse">
      <bb-load-button-ui
        class="bb-button-bar__button"
        color="primary"
        button-size="md"
        data-role="password-form-change-password-button"
        type="submit"
        i18n="
          Change password button|Text for change password
          button@@bb-user-identity-security-center-journey.change-password-button-text"
        [isLoading]="isSubmitting"
      >
        Confirm changes
      </bb-load-button-ui>
      <button
        bbButton
        class="bb-button-bar__button"
        color="secondary"
        button-size="md"
        data-role="identity-security-center-cancel-button"
        (click)="closePasswordModal()"
        (mousedown)="closePasswordModal()"
        type="button"
        i18n="
          Cancel password button|Text for cancel password
          button@@bb-user-identity-security-center-journey.cancel-password-button-text"
      >
        Cancel
      </button>
    </div>
  </form>
</div>
